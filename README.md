# go-tg-bot 

Телеграмм бот для игры в города. также есть возможность получения информации о конкретном городе.

@cities_app_bot

## Разворачивание проекта 

### Конфигурация проекта 

В файле `configs/config.go` поменять значение `BOT_NAME`, а также добавить в конфиги константу - `TOKEN` с токеном вашего бота 

Добавить сертификаты для ssl в `/certs` если они у вас есть 

Если у вас нет сертификатов и своего сервера можно использовать `ngrok`, тогда нужно поменять строку в `main.go` на

`http.ListenAndServe(":8443", http.HandlerFunc(Handler))`

### Запуск docker контейнера 

Запустить команду внутри директории проекта: 

`docker-compose build`. 

А затем: 

`docker-compose up`. 

### Импорт базы 

Таблица с городами находится в `data\geo.sql`. Для удобства импорт вынесен в отдельный метод

При первом запуске контейнера нужно раскоментить `db.InsertGeoTable()` в `main.go`

После запуска контейнера он импортирует базу, потом закоментить обратно

### Установка хуков 

Последнее что осталось сделать установить вебхук для телеграмма. Для этого нужен https сервер, если есть, то лучше использовать свой. 

Если нету, то можно воспользоваться сервисом https://ngrok.com/. Скачиваем программу и выполняем в ней команду `ngrok http 8443`. 

Далее нужно установить вебхук, вставить ваш url и токен бота: 

`curl -F "url=https://57df6fe3b52a.ngrok.io"  https://api.telegram.org/bot{YourBotToken}/setWebhook` 

Получить информацию о состоянии хука можно запросом:

`https://api.telegram.org/bot{YourBotToken}/getWebhookInfo`
